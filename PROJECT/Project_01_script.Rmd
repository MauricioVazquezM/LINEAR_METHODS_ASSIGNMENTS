---
title: 'Proyecto Estadistica Aplicada II: Otoño 2024'
author: "Mauricio Vazquez Moran"
date: '2024-10-24'
output:
  pdf_document: default
  html_document: default
---

***Link del repositorio de GitHub: https://github.com/MauricioVazquezM/LINEAR_METHODS_ASSIGNMENTS_FALL2024***

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, tidy = TRUE, fig.width=10)

# Libraries
library(MASS)  
library(ggplot2)
library(GGally)
library(mclust)
library(kableExtra)
library(FactoMineR)
library(knitr)
library(caret)
library(dplyr)
library(gridExtra)
```

```{r, echo=FALSE}
# Lectura de los datos
data <- read.csv("C:/Users/mauva/OneDrive/Documents/ITAM/9no Semestre/METODOS LINEALES/REPOSITORIO/LINEAR_METHODS_ASSIGNMENTS_FALL2024/PROJECT/Student_Performance.csv")

# Nombres originales de las columnas
colnames(data) <- c("Hours.Studied", "Previous.Scores", "Extracurricular.Activities", 
                    "Sleep.Hours", "Sample.Question.Papers.Practiced", "Performance.Index")

# Renombrar las columnas (estandarizando los nombres de las columnas)
colnames(data) <- tolower(colnames(data))  
colnames(data) <- gsub("\\.", "_", colnames(data))  

# Acortar los nombres de las columnas
colnames(data) <- c("hrs_studied", "prev_scores", "xtr_activities", 
                    "sleep_hrs", "sample_questions", "performance_idx")
```

<br>

## Objetivo

* El conjunto de datos seleccionado para este proyecto tiene como objetivo explorar el impacto de las horas de estudio, los puntajes anteriores, las actividades extracurriculares, las horas de sueño y los exámenes de prueba en el rendimiento de los estudiantes. Se planea ajustar un modelo lineal simple para analizar el impacto de cada una de estas variables de manera individual en la variable objetivo, con el fin de determinar cuál de ellas explica mejor el rendimiento del estudiante por sí sola y brinda mejores resultados en términos de ajuste y predicción.

<br>

## Primeras observaciones

<br>

```{r, echo=FALSE}
# Revisando head
head(data) %>%
  kable(caption = "Muestra de los datos", booktabs = TRUE) %>%
  kable_styling(latex_options = c("striped", "hold_position"))
```

***Descripción*** 

* El Conjunto de Datos de rendimiento estudiantil está diseñado para examinar los factores que influyen en el rendimiento académico de los estudiantes. El conjunto de datos consta de 10,000 registros de estudiantes, y cada registro contiene información sobre varios predictores y un índice de rendimiento.

***Variables***

* ***hrs_studied:*** número total de horas que cada estudiante dedicó al estudio.
* ***prev_scores:*** puntajes obtenidos por los estudiantes en pruebas anteriores.
* ***xtr_activities:*** Si el estudiante participa en actividades extracurriculares (sí o no).
* ***sleep_hrs:*** número promedio de horas de sueño que el estudiante tiene por día.
* ***sample_question:*** número de exámenes de prueba que el estudiante practicó.

***Variable objetivo***

* ***performance_idx:*** medida del rendimiento general de cada estudiante. El índice de rendimiento representa el desempeño académico del estudiante y ha sido redondeado al número entero más cercano. El índice varía entre 10 y 100, donde valores más altos indican un mejor rendimiento.


<br>

## Análisis exploratorio de datos

***Análisis univariado de los datos***

<br>

```{r echo=FALSE}
univar_analisis <- function(data) {
  results <- list()
  
  for (feature in colnames(data)) {
    data_type <- class(data[[feature]])[1]
    
    total <- nrow(data)
    nan_count <- sum(is.na(data[[feature]]))
    no_missings <- total - nan_count
    pct_missings <- nan_count / total
    
    if (is.numeric(data[[feature]])) {
      promedio <- round(mean(data[[feature]], na.rm = TRUE),2)
      desv_estandar <- round(sd(data[[feature]], na.rm = TRUE),2)
      varianza <- round(var(data[[feature]], na.rm = TRUE),2)
      minimo <- min(data[[feature]], na.rm = TRUE)
      p10 <- quantile(data[[feature]], 0.10, na.rm = TRUE)
      q1 <- quantile(data[[feature]], 0.25, na.rm = TRUE)
      mediana <- quantile(data[[feature]], 0.50, na.rm = TRUE)
      q3 <- quantile(data[[feature]], 0.75, na.rm = TRUE)
      p90 <- quantile(data[[feature]], 0.90, na.rm = TRUE)
      p95 <- quantile(data[[feature]], 0.95, na.rm = TRUE)
      p99 <- quantile(data[[feature]], 0.99, na.rm = TRUE)
      maximo <- max(data[[feature]], na.rm = TRUE)
      
      inf_count <- sum(is.infinite(data[[feature]]) & data[[feature]] > 0)
      neg_inf_count <- sum(is.infinite(data[[feature]]) & data[[feature]] < 0)
    } else {
      promedio <- NA
      desv_estandar <- NA
      varianza <- NA
      minimo <- NA
      p1 <- NA
      p5 <- NA
      p10 <- NA
      q1 <- NA
      mediana <- NA
      q3 <- NA
      p90 <- NA
      p95 <- NA
      p99 <- NA
      maximo <- NA
      inf_count <- 0
      neg_inf_count <- 0
    }
    
    results[[length(results) + 1]] <- list(
      
      Variable = feature,
      Total = total,
      No_Missings = no_missings,
      Missings = nan_count,
      Pct_Missings = pct_missings,
      Promedio = promedio,
      Desv_Std = desv_estandar,
      Varianza = varianza,
      Minimo = minimo,
      p10 = p10,
      q1 = q1,
      Mediana = mediana,
      q3 = q3,
      p90 = p90,
      p95 = p95,
      p99 = p99,
      Maximo = maximo
    )
  }
  
  result_df <- do.call(rbind, lapply(results, as.data.frame))
  
  rownames(result_df) <- NULL
  
  return(result_df)
  
}

# Ejecucion de lafuncion
resultados <- univar_analisis(data)

# Separando el analisis
resultados_parte1 <- resultados[, c("Variable", "Total", "No_Missings", "Missings", "Pct_Missings")]

resultados_parte2 <- resultados[, c("Promedio", "Desv_Std", "Varianza", "Minimo", "p10", "q1", "Mediana", "q3", "p90", "p95", "p99", "Maximo")]

# Ver los resultados en dos partes
resultados_parte1 %>%
  kable(caption = "Análisis univariado de los datos pt. I", booktabs = TRUE) %>%
  kable_styling(latex_options = c("striped", "hold_position"))

resultados_parte2 %>%
  kable(caption = "Análisis univariado de los datos pt. II", booktabs = TRUE) %>%
  kable_styling(latex_options = c("striped", "hold_position"))

```

* Observación 1: la mayoría de los estudiantes parece estudiar entre 3 y 7 horas, con algunos extremos que alcanzan hasta 9 horas.
* Observación 2: los puntajes anteriores muestran una amplia dispersión. La mitad de los estudiantes tiene puntajes superiores a 69, lo que sugiere que algunos estudiantes ya estaban bien preparados.
* Observación 3: la mayoría de los estudiantes duerme entre 5 y 9 horas, lo que indica una variabilidad notable en los hábitos de sueño.
* Observación 4: la mayoría de los estudiantes parece practicar de 2 a 7 exámenes, pero algunos practicaron significativamente más (hasta 9).
* Observación 5: existe una considerable variabilidad en el rendimiento estudiantil. Aunque la mediana es de 55, un grupo notable de estudiantes tiene un rendimiento significativamente más bajo o más alto.
* Observación 6: no hay valores faltantes en ninguna de las variables.

<br>

***Visualización de las variables***

Como objetivo de esta sección, se busca identificar patrones, detectar datos atípicos (outliers), analizar la estructura de los datos, examinar las relaciones entre las variables y comunicar, por medio de visualizaciones, para facilitar una mejor interpretación de los datos utilizados en este análisis.

\newpage

* **Explorando la variable 'performance_idx'**

```{r fig.align='center', fig.width=6, fig.height=3, echo=FALSE}
# Curva de la variable objetivo

# Crear el histograma 
histograma <- ggplot(data, aes(x = performance_idx)) +
  geom_histogram(binwidth = 10, fill = "green", color = "black", alpha = 0.7) +
  labs(title = "Histograma de performance index", x = "performance index", y = "Frecuencia") +
  theme_minimal()+
  theme(
    plot.title = element_text(size = 9),        
    axis.title = element_text(size = 8),         
    axis.text = element_text(size = 7)           
  )

# Crear la curva de densidad 
densidad <- ggplot(data, aes(x = performance_idx)) +
  geom_density(fill = "red", alpha = 0.5) +
  labs(title = "Curva de Densidad de performance index", x = "performance index", y = "Densidad") +
  theme_minimal()+
  theme(
    plot.title = element_text(size = 9),        
    axis.title = element_text(size = 8),         
    axis.text = element_text(size = 7)           
  )

# Mostrar ambos gráficos en un solo layout
grid.arrange(histograma, densidad, ncol = 2)
```

**Observaciones**

1. Los gráficos muestran una distribución simétrica, lo que sugiere que los datos podrían aproximarse a una distribución normal. Sin embargo, la forma no es la típica campana suave que caracteriza a una distribución normal estándar.
2. Existe una clara concentración de valores en el centro de la distribución. La mayoría de los valores del performance index se encuentran entre 40 y 80, según el histograma.
3. El gráfico de densidad revela una distribución multimodal, ya que se observan dos picos en la curva, lo que indica la presencia de más de un grupo de valores predominantes en los datos.

* **Explorando predictores de 'performance_idx'**

```{r, fig.align='center',fig.width=7, fig.height=3.5, echo=FALSE}
# Muestreando
set.seed(123) 
data_sample <- data[sample(1:nrow(data), size = 300), ] 

# Crear cada scatterplot individualmente
scatter1 <- ggplot(data_sample, aes(x = hrs_studied, y = performance_idx)) +
  geom_point(color = 'blue') +
  labs(title = "Horas estudiadas vs Indice de performance", x = "hrs_studied", y = "performance_idx") +
  theme_minimal()+
  theme(
    plot.title = element_text(size = 9),        
    axis.title = element_text(size = 8),         
    axis.text = element_text(size = 7)           
  )

scatter2 <- ggplot(data_sample, aes(x = prev_scores, y = performance_idx)) +
  geom_point(color = 'green') +
  labs(title = "Scores anteriores vs Indice de performance", x = "prev_scores", y = "performance_idx") +
  theme_minimal()+
  theme(
    plot.title = element_text(size = 9),        
    axis.title = element_text(size = 8),         
    axis.text = element_text(size = 7)           
  )

scatter3 <- ggplot(data_sample, aes(x = sleep_hrs, y = performance_idx)) +
  geom_point(color = 'red') +
  labs(title = "Horas de sueño vs Indice de performance", x = "sleep_hrs", y = "performance_idx") +
  theme_minimal()+
  theme(
    plot.title = element_text(size = 9),        
    axis.title = element_text(size = 8),         
    axis.text = element_text(size = 7)           
  )

scatter4 <- ggplot(data_sample, aes(x = sample_questions, y = performance_idx)) +
  geom_point(color = 'purple') +
  labs(title = "Examenes practicados vs Indice de performance", x = "sample_questions", y = "performance_idx") +
  theme_minimal()+
  theme(
    plot.title = element_text(size = 9),        
    axis.title = element_text(size = 8),         
    axis.text = element_text(size = 7)           
  )

# Cuadrícula de 2x2
grid.arrange(scatter1, scatter2, scatter3, scatter4, ncol = 2)
```

**Observaciones**

1. No parece haber una relación clara entre las horas estudiadas y el índice de performance. Los puntos están dispersos a lo largo del eje 'performance_idx', lo que sugiere que estudiar más horas no necesariamente se traduce en un mejor performance.
2. A medida que aumentan los scores anteriores, el indice de performance también tiende a aumentar. Esto mencionado nos dice que una relación positiva entre el puntaje previo y el rendimiento actual. En otras palabras, indica que un buen desempeño en evaluaciones anteriores puede predecir un buen rendimiento en la evaluación actual.
3. Al igual que con las horas estudiadas, no hay un patrón claro entre las horas de sueño y el rendimiento. 
4. No se observa una relación clara entre el número de exámenes de práctica realizados y el índice de performance. Los puntos están distribuidos uniformemente en todas las categorías de 'sample questions'.

**Conclusión**

En el gráfico de dispersión entre la variable que representan los scores anteriores y el indice de performance, hay una clara relación positiva. A medida que los puntajes anteriores aumentan, también lo hace el índice de performance, lo que sugiere una relación lineal que podría modelarse efectivamente con una regresión lineal simple. 

Por otro lado, esta variable mencionada parece ser un fuerte predictor del índice de performance. La dispersión de los puntos sigue una tendencia ascendente notoria, indicativo que los valores altos de los scores anteriores se tienden a asociarse con valores altos del índice de performance. Por lo mencionado en los puntos antoriores, podemos hacer la suposición de que es un buen candidato para una predicción lineal.

```{r fig.align='center',fig.width=5, fig.height=3.5, echo=FALSE}

```

## Verificación de Supuestos

```{r, echo=FALSE}

```

<br>

## Ajuste de un modelo lineal simple

<br>

```{r, echo=FALSE}

```

<br>

## Analisis del modelo propuesto

<br>

```{r fig.width=10, fig.height=4.5, echo=FALSE}

```

<br>

## Conclusiones

<br>

```{r fig.width=10, fig.height=4.5, echo=FALSE}

```

