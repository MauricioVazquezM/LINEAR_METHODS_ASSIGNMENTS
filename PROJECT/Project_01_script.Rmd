---
title: 'Proyecto Estadistica Aplicada II: Otoño 2024'
author: "Mauricio Vazquez Moran"
date: '2024-10-24'
output:
  pdf_document: default
  html_document: default
---

***Link del repositorio de GitHub: https://github.com/MauricioVazquezM/LINEAR_METHODS_ASSIGNMENTS_FALL2024***

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, tidy = TRUE, fig.width=10)

# Libraries
library(MASS)  
library(ggplot2)
library(GGally)
library(mclust)
library(kableExtra)
library(FactoMineR)
library(knitr)
library(caret)
library(dplyr)
```

```{r, echo=FALSE}
# Lectura de los datos
data <- read.csv("C:/Users/mauva/OneDrive/Documents/ITAM/9no Semestre/METODOS LINEALES/REPOSITORIO/LINEAR_METHODS_ASSIGNMENTS_FALL2024/PROJECT/Student_Performance.csv")

# Nombres originales de las columnas
colnames(data) <- c("Hours.Studied", "Previous.Scores", "Extracurricular.Activities", 
                    "Sleep.Hours", "Sample.Question.Papers.Practiced", "Performance.Index")

# Renombrar las columnas (estandarizando los nombres de las columnas)
colnames(data) <- tolower(colnames(data))  
colnames(data) <- gsub("\\.", "_", colnames(data))  

# Acortar los nombres de las columnas
colnames(data) <- c("hrs_studied", "prev_scores", "xtr_activities", 
                    "sleep_hrs", "sample_questions", "performance_idx")
```

<br>

## Objetivo

* El conjunto de datos seleccionado para este proyecto tiene como objetivo explorar el impacto de las horas de estudio, los puntajes anteriores, las actividades extracurriculares, las horas de sueño y los exámenes de prueba en el rendimiento de los estudiantes. Se planea ajustar un modelo lineal simple para analizar el impacto de cada una de estas variables de manera individual en la variable objetivo, con el fin de determinar cuál de ellas explica mejor el rendimiento del estudiante por sí sola y brinda mejores resultados en términos de ajuste y predicción.

<br>

## Primeras observaciones

<br>

```{r, echo=FALSE}
# Revisando head
head(data) %>%
  kable(caption = "Muestra de los datos", booktabs = TRUE) %>%
  kable_styling(latex_options = c("striped", "hold_position"))
```

***Descripción*** 

* El Conjunto de Datos de rendimiento estudiantil está diseñado para examinar los factores que influyen en el rendimiento académico de los estudiantes. El conjunto de datos consta de 10,000 registros de estudiantes, y cada registro contiene información sobre varios predictores y un índice de rendimiento.

***Variables***

* ***hrs_studied:*** número total de horas que cada estudiante dedicó al estudio.
* ***prev_scores:*** puntajes obtenidos por los estudiantes en pruebas anteriores.
* ***xtr_activities:*** Si el estudiante participa en actividades extracurriculares (sí o no).
* ***sleep_hrs:*** número promedio de horas de sueño que el estudiante tiene por día.
* ***sample_question:*** número de exámenes de prueba que el estudiante practicó.

***Variable objetivo***

* ***performance_idx:*** medida del rendimiento general de cada estudiante. El índice de rendimiento representa el desempeño académico del estudiante y ha sido redondeado al número entero más cercano. El índice varía entre 10 y 100, donde valores más altos indican un mejor rendimiento.


<br>

## Analisis exploratorio de datos

***Analisis univariado de los datos***

<br>

```{r echo=FALSE}
univar_analisis <- function(data) {
  results <- list()
  
  for (feature in colnames(data)) {
    data_type <- class(data[[feature]])[1]
    
    total <- nrow(data)
    nan_count <- sum(is.na(data[[feature]]))
    no_missings <- total - nan_count
    pct_missings <- nan_count / total
    
    if (is.numeric(data[[feature]])) {
      promedio <- round(mean(data[[feature]], na.rm = TRUE),2)
      desv_estandar <- round(sd(data[[feature]], na.rm = TRUE),2)
      varianza <- round(var(data[[feature]], na.rm = TRUE),2)
      minimo <- min(data[[feature]], na.rm = TRUE)
      p10 <- quantile(data[[feature]], 0.10, na.rm = TRUE)
      q1 <- quantile(data[[feature]], 0.25, na.rm = TRUE)
      mediana <- quantile(data[[feature]], 0.50, na.rm = TRUE)
      q3 <- quantile(data[[feature]], 0.75, na.rm = TRUE)
      p90 <- quantile(data[[feature]], 0.90, na.rm = TRUE)
      p95 <- quantile(data[[feature]], 0.95, na.rm = TRUE)
      p99 <- quantile(data[[feature]], 0.99, na.rm = TRUE)
      maximo <- max(data[[feature]], na.rm = TRUE)
      
      inf_count <- sum(is.infinite(data[[feature]]) & data[[feature]] > 0)
      neg_inf_count <- sum(is.infinite(data[[feature]]) & data[[feature]] < 0)
    } else {
      promedio <- NA
      desv_estandar <- NA
      varianza <- NA
      minimo <- NA
      p1 <- NA
      p5 <- NA
      p10 <- NA
      q1 <- NA
      mediana <- NA
      q3 <- NA
      p90 <- NA
      p95 <- NA
      p99 <- NA
      maximo <- NA
      inf_count <- 0
      neg_inf_count <- 0
    }
    
    results[[length(results) + 1]] <- list(
      
      Variable = feature,
      Total = total,
      No_Missings = no_missings,
      Missings = nan_count,
      Pct_Missings = pct_missings,
      Promedio = promedio,
      Desv_Std = desv_estandar,
      Varianza = varianza,
      Minimo = minimo,
      p10 = p10,
      q1 = q1,
      Mediana = mediana,
      q3 = q3,
      p90 = p90,
      p95 = p95,
      p99 = p99,
      Maximo = maximo
    )
  }
  
  result_df <- do.call(rbind, lapply(results, as.data.frame))
  
  rownames(result_df) <- NULL
  
  return(result_df)
  
}

# Ejecucion de lafuncion
resultados <- univar_analisis(data)

# Separando el analisis
resultados_parte1 <- resultados[, c("Variable", "Total", "No_Missings", "Missings", "Pct_Missings")]

resultados_parte2 <- resultados[, c("Promedio", "Desv_Std", "Varianza", "Minimo", "p10", "q1", "Mediana", "q3", "p90", "p95", "p99", "Maximo")]

# Ver los resultados en dos partes
resultados_parte1 %>%
  kable(caption = "Análisis univariado de los datos pt. I", booktabs = TRUE) %>%
  kable_styling(latex_options = c("striped", "hold_position"))

resultados_parte2 %>%
  kable(caption = "Análisis univariado de los datos pt. II", booktabs = TRUE) %>%
  kable_styling(latex_options = c("striped", "hold_position"))

```

* Observación 1: la mayoría de los estudiantes parece estudiar entre 3 y 7 horas, con algunos extremos que alcanzan hasta 9 horas.
* Observación 2: los puntajes anteriores muestran una amplia dispersión. La mitad de los estudiantes tiene puntajes superiores a 69, lo que sugiere que algunos estudiantes ya estaban bien preparados.
* Observación 3: la mayoría de los estudiantes duerme entre 5 y 9 horas, lo que indica una variabilidad notable en los hábitos de sueño.
* Observación 4: la mayoría de los estudiantes parece practicar de 2 a 7 exámenes, pero algunos practicaron significativamente más (hasta 9).
* Observación 5: existe una considerable variabilidad en el rendimiento estudiantil. Aunque la mediana es de 55, un grupo notable de estudiantes tiene un rendimiento significativamente más bajo o más alto.
* Observación 6: no hay valores faltantes en ninguna de las variables.

***Visualización de las variables***

<br>

## Ajuste de un modelo lineal simple

<br>

```{r, echo=FALSE}

```

<br>

## Analisis del modelo propuesto

<br>

```{r fig.width=10, fig.height=4.5, echo=FALSE}
ggplot(data = data, aes(x = INCREMENT_CATEGORY, y = PROG_SALDOS_DISP)) + 
 geom_boxplot(alpha = 0.2) + 
 geom_violin(alpha = 0.05, color = 'gray') + 
 geom_hline(yintercept = 1, color = 'red', linetype = 2) +
 geom_point(data = mean_values_A, aes(x = INCREMENT_CATEGORY, y = PROG_SALDOS_DISP), color = "blue", size = 3, shape = 18) +
 geom_text(data = mean_values_A, aes(x = INCREMENT_CATEGORY, label = round(PROG_SALDOS_DISP, 2)), 
           color = "blue", y = 4, vjust = -1, size = 3.5) +
 ylim(0, 5) +
 labs(title = "Crecimiento de Cartera Post Incremento, por Monto Acumulado de Incremento",
      subtitle = '180 Dias Post Incremento de Linea',
      x = "Monto Acumulado de Incremento",
      y = "Evolucion de Cartera (Saldos Dispuestos) Post Incremento") +
 theme_bw()
```

<br>

## Conclusiones

<br>

```{r fig.width=10, fig.height=4.5, echo=FALSE}

```

